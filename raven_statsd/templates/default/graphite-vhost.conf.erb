<VirtualHost *:80>

	ServerName <%=@server_name%>
	DocumentRoot "<%=@document_root%>"
	ErrorLog /var/log/httpd/graphite-web-error.log
	CustomLog /var/log/httpd/graphite-web-access.log common

	RedirectMatch ^/admin(.*)admin/([^/]+)/([^/]+)$ /media/$2/$3
	Alias /media/ "/usr/lib/python2.6/site-packages/django/contrib/admin/static/admin/"
	Alias /content/ "<%=@document_root%>/content/"

	WSGIScriptAlias / /usr/share/graphite/graphite-web.wsgi
	WSGIImportScript /usr/share/graphite/graphite-web.wsgi process-group=%{GLOBAL} application-group=%{GLOBAL}

	Header set Access-Control-Allow-Origin "http://<%=@grafana_host%>"
	Header set Access-Control-Allow-Methods "GET, OPTIONS"
	Header set Access-Control-Allow-Headers "origin, authorization, accept"

	<Location "/content/">
		SetHandler None
	</Location>

	<Location "/media/">
		SetHandler None
	</Location>

</VirtualHost>

